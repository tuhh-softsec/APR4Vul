cd /workdir/RSRepair_vul4j_apache_pdfbox_VUL4J-19;
export JAVA_TOOL_OPTIONS="-Dfile.encoding=UTF8 -Duser.language=en-US -Duser.country=US -Duser.language=en";
TZ="America/New_York"; export TZ;
export PATH="/usr/lib/jvm/java-8-openjdk-amd64/bin:$PATH";
export JAVA_HOME="/usr/lib/jvm/java-8-openjdk-amd64";
timeout 240m java -Xmx4g -Xms1g -XX:MaxPermSize=512m -cp /script/../libs/jmetal.jar:/script/../repair_tools/arja.jar us.msu.cse.repair.Main \
	RSRepair \
	-DexternalProjRoot /script/../libs/arja_external \
	-DprojectDir /workdir/RSRepair_vul4j_apache_pdfbox_VUL4J-19 \
    -DtestFiltered false \
    -DrunTestCommand "mvn test -pl pdfbox -Dhttps.protocols=TLSv1.2 -Denforcer.skip=true -Dcheckstyle.skip=true -Dcobertura.skip=true -DskipITs=true -Drat.skip=true -Dlicense.skip=true -Dpmd.skip=true -Dfindbugs.skip=true -Dgpg.skip=true -Dskip.npm=true -Dskip.gulp=true -Dskip.bower=true -Danimal.sniffer.skip=true -V -B" \
	-DsrcJavaDir /workdir/RSRepair_vul4j_apache_pdfbox_VUL4J-19/pdfbox/src/main/java \
	-DbinJavaDir /workdir/RSRepair_vul4j_apache_pdfbox_VUL4J-19/pdfbox/target/classes \
	-DbinTestDir /workdir/RSRepair_vul4j_apache_pdfbox_VUL4J-19/pdfbox/target/test-classes \
	-DdiffFormat true \
	-Dseed 0 \
	-DgzoltarDataDir /script/../data/benchmarks/vul4j/perfectfl/VUL4J-19 \
	-Ddependences /root/.m2/repository/com/github/jai-imageio/jai-imageio-jpeg2000/1.3.0/jai-imageio-jpeg2000-1.3.0.jar:/root/.m2/repository/org/bouncycastle/bcpkix-jdk15on/1.54/bcpkix-jdk15on-1.54.jar:/root/.m2/repository/com/github/jai-imageio/jai-imageio-core/1.3.1/jai-imageio-core-1.3.1.jar:/root/.m2/repository/org/bouncycastle/bcmail-jdk15on/1.54/bcmail-jdk15on-1.54.jar:/root/.m2/repository/org/apache/pdfbox/fontbox/2.1.0-SNAPSHOT/fontbox-2.1.0-SNAPSHOT.jar:/root/.m2/repository/com/googlecode/java-diff-utils/diffutils/1.3.0/diffutils-1.3.0.jar:/root/.m2/repository/junit/junit/4.12/junit-4.12.jar:/root/.m2/repository/commons-logging/commons-logging/1.2/commons-logging-1.2.jar:/root/.m2/repository/com/levigo/jbig2/levigo-jbig2-imageio/1.6.5/levigo-jbig2-imageio-1.6.5.jar:/root/.m2/repository/org/bouncycastle/bcprov-jdk15on/1.54/bcprov-jdk15on-1.54.jar:/root/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar;
	echo "\n\nNode: `hostname`\n";
	echo "\n\nDate: `date`\n";
Picked up JAVA_TOOL_OPTIONS: -Dfile.encoding=UTF8 -Duser.language=en-US -Duser.country=US -Duser.language=en
OpenJDK 64-Bit Server VM warning: ignoring option MaxPermSize=512m; support was removed in 8.0
Fault localization starts...
Number of positive tests: 300
Number of negative tests: 1
Negative tests: [org.apache.pdfbox.encryption.TestSymmetricKeyEncryption#testPermissions]
Faulty Lines: 
org.apache.pdfbox.pdmodel.encryption.StandardSecurityHandler#240:1.0
Fault localization is finished!
AST parsing starts...
AST parsing is finished!
Detection of local variables starts...
Detection of local variables is finished!
Detection of fields starts...
Detection of fields is finished!
Detection of methods starts...
Detection of methods is finished!
Ingredient screener starts...
Ingredient screener is finished!
Initialization of manipulations starts...
Initialization of manipulations is finished!
Filtering of the tests starts...
Number of positive tests considered: 300
Filtering of the tests is finished!
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:336)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:45)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] uHash = new byte[32];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            currentAccessPermission = new AccessPermission(dicPermissions);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            encryptionKey = new byte[this.keyLength / 8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int length = keyLength / 8;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] uKeySalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -238,6 +238,7 @@ public final class StandardSecurityHandler extends SecurityHandler
{
currentAccessPermission = new AccessPermission(dicPermissions);
setCurrentAccessPermission(currentAccessPermission);
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,13 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (documentIDArray != null && documentIDArray.size() >= 1) {
+				COSString id = (COSString) documentIDArray.getObject(0);
+				documentIDBytes = id.getBytes();
+			} else {
+				documentIDBytes = new byte[0];
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            currentAccessPermission.setReadOnly();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int pos = 0;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ue = encryption.getUserEncryptionKey();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int sha1InputOffset = 20;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] oKeySalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] kSecond = new byte[16];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            currentAccessPermission.setReadOnly();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] ownerKeySalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            PDCryptFilterDictionary cryptFilterDictionary = new PDCryptFilterDictionary();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte buf[] = new byte[10];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] u = null;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            userKey = new byte[0];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:283)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:64)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Timeout occurs!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] userValidationSalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            SecretKeySpec keySpec = new SecretKeySpec(encryptionKey, "AES");

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream baos = new ByteArrayOutputStream();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            this.encryptionKey = new byte[this.keyLength / 8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -238,6 +238,7 @@ public final class StandardSecurityHandler extends SecurityHandler
{
currentAccessPermission = new AccessPermission(dicPermissions);
setCurrentAccessPermission(currentAccessPermission);
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] userKeySalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] userValidationSalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:283)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:64)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Timeout occurs!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            MessageDigest md = MessageDigests.getMD5();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            this.keyLength = encryption.getLength();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            StringBuilder extraInfo = new StringBuilder();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            currentAccessPermission = new AccessPermission(dicPermissions);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            COSString id = (COSString) documentIDArray.getObject(0);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
java.io.IOException: Stream Closed
	at java.io.FileInputStream.available0(Native Method)
	at java.io.FileInputStream.available(FileInputStream.java:306)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:353)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:45)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            String algorithm = "1.2.840.113549.3.2";

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] uValidationSalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:336)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:45)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            MessageDigest sha1 = MessageDigests.getSHA1();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int length = keyLength / 8;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] oValidationSalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            StringBuilder extraInfo = new StringBuilder();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] buffer = new byte[1024];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:336)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:45)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] buffer = new byte[256];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] oKeySalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] userValidationSalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            userKey = new byte[0];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte buf[] = new byte[10];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Class<?>[] argsClasses = {};
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] uKeySalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            encryptionKey = new byte[32];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] kFirst = new byte[16];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream encrypted = new ByteArrayOutputStream();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream buffer = new ByteArrayOutputStream();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int permissionInt = policy.getPermissions().getPermissionBytes();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] envelopedData = null;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,16 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (encryption.getVersion() == 4 || encryption.getVersion() == 5) {
+				PDCryptFilterDictionary stdCryptFilterDictionary = encryption
+						.getStdCryptFilterDictionary();
+				if (stdCryptFilterDictionary != null) {
+					COSName cryptFilterMethod = stdCryptFilterDictionary
+							.getCryptFilterMethod();
+					setAES(COSName.AESV2.equals(cryptFilterMethod)
+							|| COSName.AESV3.equals(cryptFilterMethod));
+				}
+			}

encryptionKey =
computeEncryptedKey(
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:283)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:64)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Timeout occurs!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,9 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[][] recipientFieldsBytes = new byte[encryption
+					.getRecipientsLength()][];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            boolean foundRecipient = false;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,37 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (isOwnerPassword(password.getBytes(passwordCharset), userKey,
+					ownerKey, dicPermissions, documentIDBytes, dicRevision,
+					dicLength, encryptMetadata)) {
+				currentAccessPermission = AccessPermission
+						.getOwnerAccessPermission();
+				setCurrentAccessPermission(currentAccessPermission);
+				byte[] computedPassword;
+				if (dicRevision == 6 || dicRevision == 5) {
+					computedPassword = password.getBytes(passwordCharset);
+				} else {
+					computedPassword = getUserPassword(
+							password.getBytes(passwordCharset), ownerKey,
+							dicRevision, dicLength);
+				}
+				encryptionKey = computeEncryptedKey(computedPassword, ownerKey,
+						userKey, oe, ue, dicPermissions, documentIDBytes,
+						dicRevision, dicLength, encryptMetadata, true);
+			} else if (isUserPassword(password.getBytes(passwordCharset),
+					userKey, ownerKey, dicPermissions, documentIDBytes,
+					dicRevision, dicLength, encryptMetadata)) {
+				currentAccessPermission = new AccessPermission(dicPermissions);
+				setCurrentAccessPermission(currentAccessPermission);
+				encryptionKey = computeEncryptedKey(
+						password.getBytes(passwordCharset), ownerKey, userKey,
+						oe, ue, dicPermissions, documentIDBytes, dicRevision,
+						dicLength, encryptMetadata, false);
+			} else {
+				throw new InvalidPasswordException(
+						"Cannot decrypt PDF, the password is incorrect");
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,9 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (encryption.getLength() != 0) {
+				this.keyLength = encryption.getLength();
+			}

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            setAES(true);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] oValidationSalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,36 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (isOwnerPassword(password.getBytes(passwordCharset), userKey,
+					ownerKey, dicPermissions, documentIDBytes, dicRevision,
+					dicLength, encryptMetadata)) {
+				currentAccessPermission = AccessPermission
+						.getOwnerAccessPermission();
+				setCurrentAccessPermission(currentAccessPermission);
+				byte[] computedPassword;
+				if (dicRevision == 6 || dicRevision == 5) {
+					computedPassword = password.getBytes(passwordCharset);
+				} else {
+					computedPassword = getUserPassword(
+							password.getBytes(passwordCharset), ownerKey,
+							dicRevision, dicLength);
+				}
+				encryptionKey = computeEncryptedKey(computedPassword, ownerKey,
+						userKey, oe, ue, dicPermissions, documentIDBytes,
+						dicRevision, dicLength, encryptMetadata, true);
+			} else if (isUserPassword(password.getBytes(passwordCharset),
+					userKey, ownerKey, dicPermissions, documentIDBytes,
+					dicRevision, dicLength, encryptMetadata)) {
+				currentAccessPermission = new AccessPermission(dicPermissions);
+				setCurrentAccessPermission(currentAccessPermission);
+				encryptionKey = computeEncryptedKey(
+						password.getBytes(passwordCharset), ownerKey, userKey,
+						oe, ue, dicPermissions, documentIDBytes, dicRevision,
+						dicLength, encryptMetadata, false);
+			} else {
+				throw new InvalidPasswordException(
+						"Cannot decrypt PDF, the password is incorrect");
+			}

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Class<?>[] argsClasses = { policy.getClass() };
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:336)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:45)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream result = new ByteArrayOutputStream();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] seed = new byte[20];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:283)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:45)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,16 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (encryption.getVersion() == 4 || encryption.getVersion() == 5) {
+				PDCryptFilterDictionary stdCryptFilterDictionary = encryption
+						.getStdCryptFilterDictionary();
+				if (stdCryptFilterDictionary != null) {
+					COSName cryptFilterMethod = stdCryptFilterDictionary
+							.getCryptFilterMethod();
+					setAES(COSName.AESV2.equals(cryptFilterMethod)
+							|| COSName.AESV3.equals(cryptFilterMethod));
+				}
+			}

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] uKeySalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Class<?>[] argsClasses = {};

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            MessageDigest md = MessageDigests.getSHA1();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] buffer = new byte[256];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            currentAccessPermission.setReadOnly();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 0
Fitness: 0.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            boolean foundRecipient = false;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Class<?>[] argsClasses = {};

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,11 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (dicRevision == 6 || dicRevision == 5) {
+				passwordCharset = Charsets.UTF_8;
+				ue = encryption.getUserEncryptionKey();
+				oe = encryption.getOwnerEncryptionKey();
+			}

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,10 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            encryptionKey = computeEncryptedKey(
+					password.getBytes(passwordCharset), ownerKey, userKey, oe,
+					ue, dicPermissions, documentIDBytes, dicRevision,
+					dicLength, encryptMetadata, false);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] buffer = new byte[1024];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            encryptionKey = new byte[this.keyLength / 8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            encryptionKey = new byte[32];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] envelopedData = null;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int pos = 0;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] buffer = new byte[256];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] finalResult = new byte[32];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            SecureRandom rnd = new SecureRandom();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Object[] args = { policy };

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,9 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (encryption.getLength() != 0) {
+				this.keyLength = encryption.getLength();
+			}

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] uKeySalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] padded = new byte[ENCRYPT_PADDING.length];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int j = 0;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] userValidationSalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            userKey = new byte[0];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int keyIndex = 0;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] userKeySalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Object[] args = {};

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] uHash = new byte[32];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            String userPassword = policy.getUserPassword();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            boolean foundRecipient = false;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int keyIndex = 0;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:336)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:58)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Timeout occurs!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Object[] args = { policy };

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,9 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[][] recipientFieldsBytes = new byte[encryption
+					.getRecipientsLength()][];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] buffer = new byte[1024];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] finalResult = new byte[32];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int j = 0;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] u = null;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            String algorithm = "1.2.840.113549.3.2";

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Class<?>[] argsClasses = { policy.getClass() };
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,10 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (dicRevision == 6 || dicRevision == 5) {
+				validatePerms(encryption, dicPermissions, encryptMetadata);
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] userKeySalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] kTrunc = new byte[32];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:336)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:45)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int saltIndex = 0;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] perms = new byte[16];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] uKeySalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] finalResult = new byte[32];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            MessageDigest md = MessageDigests.getMD5();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] o = null;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            boolean foundRecipient = false;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ue = encryption.getUserEncryptionKey();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            currentAccessPermission = AccessPermission
+					.getOwnerAccessPermission();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            COSArray array = new COSArray();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Object[] args = { policy };

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream baos = new ByteArrayOutputStream();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            String certSerial = "unknown";

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            currentAccessPermission.setReadOnly();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 0
Fitness: 0.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            setAES(true);
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:336)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:58)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Timeout occurs!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] kSecond = new byte[16];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:336)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:45)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,11 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (!(decryptionMaterial instanceof PublicKeyDecryptionMaterial)) {
+				throw new IOException(
+						"Provided decryption material is not compatible with the document");
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,20 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (isUserPassword(password.getBytes(passwordCharset), userKey,
+					ownerKey, dicPermissions, documentIDBytes, dicRevision,
+					dicLength, encryptMetadata)) {
+				currentAccessPermission = new AccessPermission(dicPermissions);
+				setCurrentAccessPermission(currentAccessPermission);
+				encryptionKey = computeEncryptedKey(
+						password.getBytes(passwordCharset), ownerKey, userKey,
+						oe, ue, dicPermissions, documentIDBytes, dicRevision,
+						dicLength, encryptMetadata, false);
+			} else {
+				throw new InvalidPasswordException(
+						"Cannot decrypt PDF, the password is incorrect");
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] kSecond = new byte[16];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            String certSerial = "unknown";

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            boolean encryptMetaData = true;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            validatePerms(encryption, dicPermissions, encryptMetadata);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int permissionInt = policy.getPermissions().getPermissionBytes();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,12 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (dicRevision == 6 || dicRevision == 5) {
+				passwordCharset = Charsets.UTF_8;
+				ue = encryption.getUserEncryptionKey();
+				oe = encryption.getOwnerEncryptionKey();
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] kSecond = new byte[16];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,11 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (!(decryptionMaterial instanceof StandardDecryptionMaterial)) {
+				throw new IOException(
+						"Decryption material is not compatible with the document");
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] pkcs7input = new byte[24];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] ownerValidationSalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,11 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (!(decryptionMaterial instanceof PublicKeyDecryptionMaterial)) {
+				throw new IOException(
+						"Provided decryption material is not compatible with the document");
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Object[] args = {};
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] envelopedData = null;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] finalResult = new byte[32];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,11 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (keyLength == 256) {
+				throw new IOException(
+						"256 bit key length is not supported yet for public key security");
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            keyLength = policy.getEncryptionKeyLength();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,12 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (documentIDArray != null && documentIDArray.size() >= 1) {
+				COSString id = (COSString) documentIDArray.getObject(0);
+				documentIDBytes = id.getBytes();
+			} else {
+				documentIDBytes = new byte[0];
+			}

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,37 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (isOwnerPassword(password.getBytes(passwordCharset), userKey,
+					ownerKey, dicPermissions, documentIDBytes, dicRevision,
+					dicLength, encryptMetadata)) {
+				currentAccessPermission = AccessPermission
+						.getOwnerAccessPermission();
+				setCurrentAccessPermission(currentAccessPermission);
+				byte[] computedPassword;
+				if (dicRevision == 6 || dicRevision == 5) {
+					computedPassword = password.getBytes(passwordCharset);
+				} else {
+					computedPassword = getUserPassword(
+							password.getBytes(passwordCharset), ownerKey,
+							dicRevision, dicLength);
+				}
+				encryptionKey = computeEncryptedKey(computedPassword, ownerKey,
+						userKey, oe, ue, dicPermissions, documentIDBytes,
+						dicRevision, dicLength, encryptMetadata, true);
+			} else if (isUserPassword(password.getBytes(passwordCharset),
+					userKey, ownerKey, dicPermissions, documentIDBytes,
+					dicRevision, dicLength, encryptMetadata)) {
+				currentAccessPermission = new AccessPermission(dicPermissions);
+				setCurrentAccessPermission(currentAccessPermission);
+				encryptionKey = computeEncryptedKey(
+						password.getBytes(passwordCharset), ownerKey, userKey,
+						oe, ue, dicPermissions, documentIDBytes, dicRevision,
+						dicLength, encryptMetadata, false);
+			} else {
+				throw new InvalidPasswordException(
+						"Cannot decrypt PDF, the password is incorrect");
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ue = encryption.getUserEncryptionKey();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ue = encryption.getUserEncryptionKey();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            oe = encryption.getOwnerEncryptionKey();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int permissionInt = policy.getPermissions().getPermissionBytes();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,10 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (!(decryptionMaterial instanceof PublicKeyDecryptionMaterial)) {
+				throw new IOException(
+						"Provided decryption material is not compatible with the document");
+			}

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            boolean encryptMetaData = true;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,12 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (dicRevision == 6 || dicRevision == 5) {
+				passwordCharset = Charsets.UTF_8;
+				ue = encryption.getUserEncryptionKey();
+				oe = encryption.getOwnerEncryptionKey();
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read1(BufferedInputStream.java:283)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:345)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:64)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Timeout occurs!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            COSArray array = new COSArray();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] oKeySalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] oKeySalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] userValidationSalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,11 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (!(decryptionMaterial instanceof PublicKeyDecryptionMaterial)) {
+				throw new IOException(
+						"Provided decryption material is not compatible with the document");
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            COSString id = (COSString) documentIDArray.getObject(0);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            SecretKeySpec keySpec = new SecretKeySpec(encryptionKey, "AES");

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[][] recipientFieldsBytes = new byte[encryption
+					.getRecipientsLength()][];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] kTrunc = new byte[32];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            MessageDigest sha1 = MessageDigests.getSHA1();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] perms = null;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] finalResult = new byte[32];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int saltIndex = 0;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            validatePerms(encryption, dicPermissions, encryptMetadata);
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int version = computeVersionNumber();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Object[] args = {};

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int saltIndex = 0;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            boolean encryptMetaData = true;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            ByteArrayOutputStream result = new ByteArrayOutputStream();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
java.io.IOException: Stream closed
	at java.io.BufferedInputStream.getBufIfOpen(BufferedInputStream.java:170)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:336)
	at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)
	at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)
	at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)
	at java.io.InputStreamReader.read(InputStreamReader.java:184)
	at java.io.BufferedReader.fill(BufferedReader.java:161)
	at java.io.BufferedReader.readLine(BufferedReader.java:324)
	at java.io.BufferedReader.readLine(BufferedReader.java:389)
	at us.msu.cse.repair.core.util.StreamReaderThread.run(StreamReaderThread.java:36)
java.lang.IllegalStateException: Exception Occurred
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runShell(RExternalTestExecutor.java:119)
	at us.msu.cse.repair.core.testexecutors.RExternalTestExecutor.runTests(RExternalTestExecutor.java:64)
	at us.msu.cse.repair.ec.problems.GenProgProblem.invokeTestExecutor(GenProgProblem.java:144)
	at us.msu.cse.repair.ec.problems.GenProgProblem.evaluate(GenProgProblem.java:99)
	at us.msu.cse.repair.ec.algorithms.RSRepairRandomSearch.execute(RSRepairRandomSearch.java:34)
	at us.msu.cse.repair.core.AbstractRepairAlgorithm.execute(AbstractRepairAlgorithm.java:18)
	at us.msu.cse.repair.RSRepairMain.main(RSRepairMain.java:44)
	at us.msu.cse.repair.Main.main(Main.java:12)
Timeout occurs!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] perms = null;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            MessageDigest md = MessageDigests.getMD5();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,16 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (encryption.getVersion() == 4 || encryption.getVersion() == 5) {
+				PDCryptFilterDictionary stdCryptFilterDictionary = encryption
+						.getStdCryptFilterDictionary();
+				if (stdCryptFilterDictionary != null) {
+					COSName cryptFilterMethod = stdCryptFilterDictionary
+							.getCryptFilterMethod();
+					setAES(COSName.AESV2.equals(cryptFilterMethod)
+							|| COSName.AESV3.equals(cryptFilterMethod));
+				}
+			}

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] perms = new byte[16];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] userKeySalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte buf[] = new byte[10];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] envelopedData = null;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Object[] args = { policy };

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Object[] args = { policy };

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            String algorithm = "1.2.840.113549.3.2";

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] buffer = new byte[1024];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int recipientFieldsLength = 0;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int saltIndex = 0;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Class<?>[] argsClasses = {};
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            String ownerPassword = policy.getOwnerPassword();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,11 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (!(decryptionMaterial instanceof StandardDecryptionMaterial)) {
+				throw new IOException(
+						"Decryption material is not compatible with the document");
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] oHash = new byte[32];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] finalResult = new byte[32];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            encryptionKey = new byte[this.keyLength / 8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            setDecryptMetadata(encryption.isEncryptMetaData());

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            Class<?>[] argsClasses = {};

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            String algorithm = "1.2.840.113549.3.2";
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] perms = null;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,36 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (isOwnerPassword(password.getBytes(passwordCharset), userKey,
+					ownerKey, dicPermissions, documentIDBytes, dicRevision,
+					dicLength, encryptMetadata)) {
+				currentAccessPermission = AccessPermission
+						.getOwnerAccessPermission();
+				setCurrentAccessPermission(currentAccessPermission);
+				byte[] computedPassword;
+				if (dicRevision == 6 || dicRevision == 5) {
+					computedPassword = password.getBytes(passwordCharset);
+				} else {
+					computedPassword = getUserPassword(
+							password.getBytes(passwordCharset), ownerKey,
+							dicRevision, dicLength);
+				}
+				encryptionKey = computeEncryptedKey(computedPassword, ownerKey,
+						userKey, oe, ue, dicPermissions, documentIDBytes,
+						dicRevision, dicLength, encryptMetadata, true);
+			} else if (isUserPassword(password.getBytes(passwordCharset),
+					userKey, ownerKey, dicPermissions, documentIDBytes,
+					dicRevision, dicLength, encryptMetadata)) {
+				currentAccessPermission = new AccessPermission(dicPermissions);
+				setCurrentAccessPermission(currentAccessPermission);
+				encryptionKey = computeEncryptedKey(
+						password.getBytes(passwordCharset), ownerKey, userKey,
+						oe, ue, dicPermissions, documentIDBytes, dicRevision,
+						dicLength, encryptMetadata, false);
+			} else {
+				throw new InvalidPasswordException(
+						"Cannot decrypt PDF, the password is incorrect");
+			}

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] userKeySalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,11 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            encryptionKey = computeEncryptedKey(
+					password.getBytes(passwordCharset), ownerKey, userKey, oe,
+					ue, dicPermissions, documentIDBytes, dicRevision,
+					dicLength, encryptMetadata, false);
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int i = 0;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,11 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            encryptionKey = computeEncryptedKey(
+					password.getBytes(passwordCharset), ownerKey, userKey, oe,
+					ue, dicPermissions, documentIDBytes, dicRevision,
+					dicLength, encryptMetadata, false);
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] o = null;
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,12 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            if (dicRevision == 6 || dicRevision == 5) {
+				passwordCharset = Charsets.UTF_8;
+				ue = encryption.getUserEncryptionKey();
+				oe = encryption.getOwnerEncryptionKey();
+			}
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            MessageDigest md = MessageDigests.getSHA1();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] perms = null;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
Compilation fails!
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] finalResult = new byte[32];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] oValidationSalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            currentAccessPermission.setReadOnly();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] ownerValidationSalt = new byte[8];

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            byte[] userValidationSalt = new byte[8];
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            String algorithm = "1.2.840.113549.3.2";
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 1
Fitness: 2.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            AccessPermission ret = new AccessPermission();

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            setAES(true);
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            boolean foundRecipient = false;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,7 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            int keyIndex = 0;

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,7 +237,8 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
+            keyLength = policy.getEncryptionKeyLength();
+			setCurrentAccessPermission(currentAccessPermission);

encryptionKey =
computeEncryptedKey(
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),
Number of failed tests: 3
Fitness: 4.0
One fitness evaluation is finished...
One fitness evaluation starts...
----------------------------------
Patch Candidate:
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java
@@ -237,8 +237,6 @@ public final class StandardSecurityHandler extends SecurityHandler
dicLength, encryptMetadata) )
{
currentAccessPermission = new AccessPermission(dicPermissions);
-            setCurrentAccessPermission(currentAccessPermission);
-
encryptionKey =
computeEncryptedKey(
password.getBytes(passwordCharset),


Node: 1cb1d8aedd75



Date: Tue Dec  6 12:22:42 EST 2022

